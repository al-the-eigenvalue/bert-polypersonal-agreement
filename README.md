# ModularLM  
В данном репозитории представлен код для проекта «Локализация грамматики», направленного на исследование того, как трансформерные языковые модели интернализируют новые синтетические грамматические категории.  
Проект фокусируется на добавлении в русский язык искусственного полиперсонального согласования (маркировки объекта на глаголе) и анализе того, как это отражается в представлениях модели.  
  
# Идея проекта  
Мы исследуем, способна ли модель типа BERT:
- локализовать новую грамматическую категорию в отдельных слоях,
- разделять полиперсональные и обычные предложения в пространстве представлений,
- формировать структурированные внутренние различия после дообучения.  
В качестве базовой архитектуры используется RuBERT — русскоязычная версия BERT.

#  Этапы проекта
## Подготовка данных
Использован синтетический полиперсональный русский язык, полученный прошлой командой добавлением дополнительных личных окончаний к глаголам, имеющим прямой объект.
генерация полиперсональных форм контроль корректности синтетических токенов сохранение грамматических признаков. Для экспериментов в рамках данного проекта маскировались прямые объекты.  
## Behavioral Probing  
Оценка модели на задаче *masked object completion* — насколько хорошо предсказание [MASK] отражает признаки объекта (лицо, число) в синтетических формах.
##  Diagnostic Probing
- обучение логистического классификатора на embeddings;
- проверка линейной separability полиперсональных форм;
- оценка, насколько легко линейно отделить синтетические случаи.  
###  Анализ Attention

Эксперименты по извлечению и анализу attention-весов от [MASK] к токенам полиперсонального окончания:  

- визуализация внимания;
- статистический анализ по головам и слоям;
- выявление слоёв, чувствительных к синтетическим маркерам.  
Исполнители и выполненные задачи:
 * **Альберт Корнилов**:
   * оптимизация скрипта для удаления прямого объекта
   * cкрипт, который собирает скоры attention от маскированного токена к полиперсональным
   * скрипт для извлечения аттеншенов от [MASK] токена к полиперсональным
   * правка обзор литературы
   * речерч (вместе с Ангелиной) метрик дистилляции
   * оформиление статью в ACL формат
 * **Степанова Ангелина**:
   * дизайн экспериментов для поведенческого пробинга
   * дизайн экспериментов для attention
   * векторизация через предобученную модель для поведенческого и диагностического пробинга
   * ресерч (вместе с Альбертом) метрик дистилляции
   * подготовка части статьи про поведенческий пробинг
 * **Мария Сухарева**:
   * подключение к удаленному серверу по ssh для доступа к видеокарте
   * обучение полного BERT
   * ресерч методов дистилляции и подбор моделей
   * разработка пайплайна дистилляции
   * подготовка части статьи (общий флоу, abstract, заключение, limitations), вычитка полного текста
 * **Лада Шумакова**:
   * подготовка датасета для поведенческого пробинга (удаление прямого объекта)
   * подготовка датасета для диагностического пробинга (генерация ошибок)
   * обучение классификаторов для диагностического пробинга
   * написание обзора литературы для статьи
   * подготовка части статьи про диагностический пробинг
